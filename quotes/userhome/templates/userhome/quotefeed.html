{% load static %}
<!-- Quote Feed Section -->
<div class="container py-4">
  <div class="row g-4">
    {% for quote in quotes %}
    <div class="col-lg-10 mx-auto">
      <div class="card quote-card shadow-sm border-0 rounded-4 quote-animation">
        <!-- User Info Header - Simplified layout -->
        <div class="card-header bg-transparent border-bottom py-3">
          <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
              <div class="me-3">
                {% if quote.user.userinfo.profile_picture %}
                <img class="rounded-circle border border-2" src="{{ quote.user.userinfo.profile_picture.url }}" alt="Profile picture" width="45" height="45">
                {% else %}
                <div class="rounded-circle d-flex align-items-center justify-content-center" style="width: 45px; height: 45px;">
                  <i class="fas fa-user"></i>
                </div>
                {% endif %}
              </div>
              <div>
                <h6 class="mb-0 fw-bold">{{ quote.user }}</h6>
                <small>{{ quote.posted_date }}</small>
              </div>
            </div>
            
            <div class="dropdown">
              <button class="btn btn-sm p-1" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-ellipsis-h"></i>
              </button>
              <ul class="dropdown-menu dropdown-menu-end shadow-sm">
                <li><a class="dropdown-item d-flex align-items-center" href="#"><i class="fas fa-eye-slash me-2"></i> Hide</a></li>
                <li><a class="dropdown-item d-flex align-items-center" href="#"><i class="fas fa-flag me-2"></i> Report</a></li>
                <li><a class="dropdown-item d-flex align-items-center" href="#"><i class="fas fa-share me-2"></i> Share</a></li>
              </ul>
            </div>
          </div>
        </div>
        
        <!-- Quote Content - Enhanced presentation -->
        <div class="card-body py-4">
          <div class="position-relative px-2 py-3">
            <i class="fas fa-quote-left position-absolute" style="opacity: 0.15; font-size: 1.75rem; left: -5px; top: -10px;"></i>
            <div class="px-4">
              <p class="fs-5 brand-font lh-base">{{ quote.quote }}</p>
            </div>
            <i class="fas fa-quote-right position-absolute" style="opacity: 0.15; font-size: 1.75rem; right: -5px; bottom: -10px;"></i>
          </div>
        </div>
        
        <!-- Interaction Buttons - Streamlined -->
        <div class="card-footer bg-transparent py-2 border-top">
          <div class="d-flex align-items-center justify-content-between px-2">
            <div class="d-flex gap-4">
              {% include 'userhome/components/interaction_buttons.html' with content_type='quote' content_id=quote.id %}
            </div>
          </div>
        </div>
        
        <!-- Comments Section - Collapsible -->
        <div class="collapse" id="comments-{{ quote.id }}">
          <div class="card-body pt-0 pb-3 border-top">
            {% include 'userhome/components/comments_section.html' with content_type='quote' content_id=quote.id comments=quote.comments.all %}
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- No Quotes Message - Improved design -->
{% if not quotes %}
<div class="container py-5">
  <div class="row">
    <div class="col-lg-8 col-md-10 mx-auto">
      <div class="text-center py-5">
        <div class="mb-4">
          <i class="fas fa-quote-right fa-4x" style="opacity: 0.3;"></i>
        </div>
        <h3 class="mb-3">Your Quote Feed is Empty</h3>
        <p class="mb-4">Share your favorite inspirational quotes and connect with others.</p>
        <button class="btn btn-custom rounded-pill px-4" data-bs-toggle="modal" data-bs-target="#addquote">
          <i class="fas fa-plus me-2"></i> Add Your First Quote
        </button>
      </div>
    </div>
  </div>
</div>
{% endif %}

<script>
  // Show/hide back-to-top button
  window.addEventListener('scroll', function() {
    const backToTopButton = document.getElementById('back-to-top');
    if (window.scrollY > 300) {
      backToTopButton.style.display = 'flex';
      backToTopButton.style.opacity = '1';
    } else {
      backToTopButton.style.opacity = '0';
      setTimeout(() => {
        if (window.scrollY <= 300) {
          backToTopButton.style.display = 'none';
        }
      }, 300);
    }
  });
  
  // Scroll to top when back-to-top button is clicked
  document.getElementById('back-to-top').addEventListener('click', function() {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  });
  
  // Enhanced animation for quotes when they enter viewport
  document.addEventListener('DOMContentLoaded', function() {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('show');
          // Add slight delay between animations if multiple cards appear
          setTimeout(() => {
            observer.unobserve(entry.target);
          }, 150);
        }
      });
    }, {
      threshold: 0.2,
      rootMargin: '0px 0px -50px 0px'
    });
    
    document.querySelectorAll('.quote-animation').forEach((quote, index) => {
      // Add staggered observation to create cascade effect
      setTimeout(() => {
        observer.observe(quote);
      }, index * 100);
    });
  });
</script>